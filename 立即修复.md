# âš¡ ç«‹å³ä¿®å¤æ•°æ®åº“é—®é¢˜

## é—®é¢˜åŸå› 

V2 è¿ç§»è„šæœ¬æ‰§è¡Œå¤±è´¥ï¼Œå¯¼è‡´æ•°æ®åº“å¤„äºåŠå®ŒæˆçŠ¶æ€ã€‚

## ğŸ¯ è§£å†³æ–¹æ¡ˆï¼ˆ3 æ­¥æå®šï¼‰

### æ­¥éª¤ 1ï¼šæ¸…ç©ºæ•°æ®åº“

**åœ¨ MySQL å®¢æˆ·ç«¯æˆ–å‘½ä»¤è¡Œä¸­æ‰§è¡Œ**ï¼š

```sql
-- æ–¹å¼ Aï¼šå¦‚æœå·²ç»ç™»å½• MySQL
DROP DATABASE IF EXISTS workflow;
CREATE DATABASE workflow CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

**æˆ–è€…åœ¨å‘½ä»¤è¡Œä¸€è¡Œæ‰§è¡Œ**ï¼š

```bash
mysql -u root -p1qaz2wsx -e "DROP DATABASE IF EXISTS workflow; CREATE DATABASE workflow CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
```

### æ­¥éª¤ 2ï¼šé‡æ–°å¯åŠ¨åº”ç”¨

```bash
cd /Users/yanchao/IdeaProjects/workFolw/backend
mvn spring-boot:run
```

### æ­¥éª¤ 3ï¼šè§‚å¯Ÿæ—¥å¿—

æˆåŠŸçš„æ ‡å¿—ï¼š
```
âœ“ Flyway - Migrating schema `workflow` to version "1 - init tables"
âœ“ Flyway - Migrating schema `workflow` to version "2 - init data"  
âœ“ Flyway - Successfully applied 2 migrations
âœ“ Flowable ProcessEngine initialized
âœ“ Started WorkFlowApplication in X seconds
```

---

## ğŸ”§ å¦‚æœ MySQL å‘½ä»¤æ‰¾ä¸åˆ°

### æ‰¾åˆ° MySQL è·¯å¾„

```bash
# æ–¹å¼ 1ï¼šä½¿ç”¨ which
which mysql

# æ–¹å¼ 2ï¼šæŸ¥æ‰¾å¸¸è§ä½ç½®
ls /usr/local/mysql/bin/mysql
ls /usr/local/bin/mysql
ls /opt/homebrew/bin/mysql

# æ–¹å¼ 3ï¼šå¦‚æœå®‰è£…äº† Homebrew
brew list mysql
```

### ä½¿ç”¨å®Œæ•´è·¯å¾„

```bash
# ç¤ºä¾‹ï¼ˆæ›¿æ¢ä¸ºå®é™…è·¯å¾„ï¼‰
/usr/local/mysql/bin/mysql -u root -p1qaz2wsx -e "DROP DATABASE IF EXISTS workflow; CREATE DATABASE workflow CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
```

---

## ğŸ¨ ä½¿ç”¨å›¾å½¢åŒ–å·¥å…·ï¼ˆæ›´ç®€å•ï¼‰

### æ–¹å¼ Aï¼šMySQL Workbench

1. æ‰“å¼€ MySQL Workbench
2. è¿æ¥åˆ°æœ¬åœ°æ•°æ®åº“ï¼ˆroot/1qaz2wsxï¼‰
3. åœ¨ SQL ç¼–è¾‘å™¨ä¸­æ‰§è¡Œï¼š
```sql
DROP DATABASE IF EXISTS workflow;
CREATE DATABASE workflow CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```
4. ç‚¹å‡»æ‰§è¡Œï¼ˆé—ªç”µå›¾æ ‡ï¼‰

### æ–¹å¼ Bï¼šNavicat / DBeaver / TablePlus

1. è¿æ¥åˆ°æ•°æ®åº“
2. å³é”® workflow æ•°æ®åº“ â†’ åˆ é™¤
3. æ–°å»ºæ•°æ®åº“ â†’ åç§°ï¼šworkflowï¼Œå­—ç¬¦é›†ï¼šutf8mb4

---

## ğŸš€ ä½¿ç”¨ IDEA æ•°æ®åº“å·¥å…·ï¼ˆæœ€æ–¹ä¾¿ï¼‰

### åœ¨ IntelliJ IDEA ä¸­æ“ä½œ

1. **æ‰“å¼€ Database é¢æ¿**
   - View â†’ Tool Windows â†’ Database
   - æˆ–ç‚¹å‡»å³ä¾§çš„ "Database" æ ‡ç­¾

2. **æ·»åŠ æ•°æ®åº“è¿æ¥**ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
   - ç‚¹å‡» + â†’ Data Source â†’ MySQL
   - Host: localhost
   - Port: 3306
   - User: root
   - Password: 1qaz2wsx
   - Database: workflow
   - ç‚¹å‡» "Test Connection"
   - ç‚¹å‡» "OK"

3. **åˆ é™¤å¹¶é‡å»ºæ•°æ®åº“**
   - å³é”® workflow æ•°æ®åº“ â†’ Drop
   - å³é”® MySQL è¿æ¥ â†’ New â†’ Database
   - Name: workflow
   - Charset: utf8mb4
   - ç‚¹å‡» "OK"

4. **é‡æ–°å¯åŠ¨åº”ç”¨**
   - å³é”® WorkFlowApplication.java â†’ Run

---

## ğŸ“‹ å®Œæ•´æ“ä½œæ£€æŸ¥æ¸…å•

- [ ] **æ­¥éª¤ 1**ï¼šæ¸…ç©ºæ•°æ®åº“ workflow
- [ ] **æ­¥éª¤ 2**ï¼šé‡å»ºæ•°æ®åº“ workflowï¼ˆå­—ç¬¦é›† utf8mb4ï¼‰
- [ ] **æ­¥éª¤ 3**ï¼šå¯åŠ¨åº”ç”¨ `mvn spring-boot:run`
- [ ] **æ­¥éª¤ 4**ï¼šè§‚å¯Ÿæ—¥å¿—ç¡®è®¤ Flyway æˆåŠŸæ‰§è¡Œ
- [ ] **æ­¥éª¤ 5**ï¼šéªŒè¯æ•°æ®åº“è¡¨ï¼ˆçº¦ 85 å¼ è¡¨ï¼‰

---

## âœ… éªŒè¯ä¿®å¤æˆåŠŸ

### 1. æ£€æŸ¥å¯åŠ¨æ—¥å¿—

```log
âœ… çœ‹åˆ°è¿™äº›å°±æˆåŠŸäº†ï¼š
- Flyway - Successfully applied 2 migrations
- Flowable ProcessEngine initialized  
- Started WorkFlowApplication
```

### 2. æ£€æŸ¥æ•°æ®åº“

ç™»å½• MySQL åæ‰§è¡Œï¼š

```sql
-- æŸ¥çœ‹æ‰€æœ‰è¡¨
SHOW TABLES;

-- åº”è¯¥çœ‹åˆ°çº¦ 85 å¼ è¡¨
SELECT COUNT(*) FROM information_schema.TABLES 
WHERE TABLE_SCHEMA = 'workflow';

-- éªŒè¯ Flyway å†å²
SELECT * FROM flyway_schema_history;

-- éªŒè¯åˆå§‹æ•°æ®
SELECT * FROM sys_user;
```

---

## ğŸ› å¦‚æœè¿˜æ˜¯å¤±è´¥

### æ£€æŸ¥ V2 è„šæœ¬

å¦‚æœ V2 è„šæœ¬æœ¬èº«æœ‰é—®é¢˜ï¼Œå¯ä»¥ä¸´æ—¶ç¦ç”¨ï¼š

```bash
# é‡å‘½åè„šæœ¬ï¼ˆä¸´æ—¶è·³è¿‡ï¼‰
cd backend/src/main/resources/db/migration
mv V2__init_data.sql V2__init_data.sql.bak

# å¯åŠ¨åº”ç”¨ï¼ˆåªæ‰§è¡Œ V1ï¼‰
cd ../../../../../../
mvn spring-boot:run

# å¯åŠ¨æˆåŠŸåï¼Œæ‰‹åŠ¨æ‰§è¡Œ V2
mysql -u root -p1qaz2wsx workflow < src/main/resources/db/migration/V2__init_data.sql.bak

# æ¢å¤æ–‡ä»¶å
mv V2__init_data.sql.bak V2__init_data.sql
```

---

## ğŸ’¡ å¿«é€Ÿå‘½ä»¤

**å¦‚æœ MySQL å‘½ä»¤å¯ç”¨**ï¼š

```bash
# ä¸€è¡Œæå®šï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼‰
mysql -u root -p1qaz2wsx -e "DROP DATABASE IF EXISTS workflow; CREATE DATABASE workflow CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;" && cd backend && mvn spring-boot:run
```

**å¦‚æœæ²¡æœ‰ MySQL å‘½ä»¤**ï¼š

1. ä½¿ç”¨å›¾å½¢åŒ–å·¥å…·åˆ é™¤å¹¶é‡å»º workflow æ•°æ®åº“
2. è¿è¡Œï¼š`cd backend && mvn spring-boot:run`

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé—®é¢˜æŒç»­ï¼Œå¯èƒ½æ˜¯ï¼š
1. V1 æˆ– V2 è„šæœ¬æœ¬èº«æœ‰è¯­æ³•é”™è¯¯
2. MySQL æƒé™ä¸è¶³
3. å­—ç¬¦é›†ä¸åŒ¹é…

è¯·è´´å‡ºæ–°çš„é”™è¯¯æ—¥å¿—ï¼Œæˆ‘ä¼šå¸®æ‚¨ç»§ç»­æ’æŸ¥ã€‚

---

**ğŸ¯ æœ€ç®€å•çš„æ–¹æ³•ï¼šä½¿ç”¨ IDEA çš„ Database å·¥å…·åˆ é™¤å¹¶é‡å»ºæ•°æ®åº“ï¼Œç„¶åé‡æ–°è¿è¡Œåº”ç”¨ï¼**

